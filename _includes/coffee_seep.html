<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coffee Percolation Animation</title>
  <style>
    /* Center the SVG on the page */
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0;
      background-color: #f0f0f0;
    }
    svg {
      border: 1px solid black;
    }
  </style>
</head>
<body>

<!-- The SVG container will be injected here by JavaScript -->
<div id="water-animation"></div>

<script>
  function createCoffeePercolation() {
    const width = 400;
    const height = 400;
    const cols = 10;
    const rows = 9;
    const offset = 10;
    const radius = width / (cols * 2); // Adjusted so circles just touch
    const spacing = radius * 1.88;
    const stripWidth = width * 0.95; // Restrict blue and yellow strips within black strips
    const stripOffset = (width - stripWidth) / 2;

    // Create the SVG container
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", width);
    svg.setAttribute("height", height);

    // Add light blue strip on top
    const topStrip = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    topStrip.setAttribute("x", stripOffset);
    topStrip.setAttribute("width", stripWidth);
    topStrip.setAttribute("height", radius * 1.5);
    topStrip.setAttribute("fill", "lightblue");
    svg.appendChild(topStrip);

    const circles = [];

    for (let r = 0; r < rows; r++) {
      for (let c = 0; c < cols; c++) {
        const x = c * spacing + radius + offset + (r % 2 === 0 ? 0 : radius);
        const y = r * spacing + radius;
        const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");

        circle.setAttribute("cx", x);
        circle.setAttribute("cy", y + radius * 1.5); // Adjust for strip
        circle.setAttribute("r", radius);
        circle.setAttribute("stroke", "#6F4E37");
        circle.setAttribute("stroke-width", "2");
        circle.setAttribute("fill", "white");

        svg.appendChild(circle);
        circles.push(circle);
      }
    }

    // Add thin yellow strip at the bottom
    const bottomStrip = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    bottomStrip.setAttribute("x", stripOffset);
    bottomStrip.setAttribute("y", height - radius * 1.5);
    bottomStrip.setAttribute("width", stripWidth);
    bottomStrip.setAttribute("height", radius * 1.5);
    bottomStrip.setAttribute("fill", "yellow");
    svg.appendChild(bottomStrip);

    // Add black strips on either side
    const leftBlackStrip = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    leftBlackStrip.setAttribute("width", stripOffset);
    leftBlackStrip.setAttribute("height", height);
    leftBlackStrip.setAttribute("fill", "black");
    svg.appendChild(leftBlackStrip);

    const rightBlackStrip = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    rightBlackStrip.setAttribute("x", width - stripOffset);
    rightBlackStrip.setAttribute("width", stripOffset);
    rightBlackStrip.setAttribute("height", height);
    rightBlackStrip.setAttribute("fill", "black");
    svg.appendChild(rightBlackStrip);

    async function animateFilling() {
      while (true) {
        for (let r = 0; r < rows; r++) {
          await new Promise(resolve => setTimeout(resolve, 500)); // Delay for animation
          for (let c = 0; c < cols; c++) {
            const index = r * cols + c;
            circles[index].setAttribute("fill", "#6F4E37");
          }
        }
        await new Promise(resolve => setTimeout(resolve, 1000)); // Pause before resetting
        circles.forEach(circle => circle.setAttribute("fill", "white"));
      }
    }

    animateFilling();
    return svg;
  }

  // Append the generated SVG to the DOM
  document.getElementById('water-animation').appendChild(createCoffeePercolation());
</script>

</body>
</html>
